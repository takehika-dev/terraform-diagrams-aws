# AWS Infrastructure with Terraform and Diagrams
AWS infrastructure using Terraform and visualizing its configuration with [diagrams](https://diagrams.mingrammer.com/).


## Overview of Created AWS Resources
This Terraform configuration creates the following AWS resources:

* **VPC:** The main Virtual Private Cloud.
* **Subnet:** One public subnet.
* **Internet Gateway:** Enables communication between the VPC and the internet.
* **Route Table:** Configures routing for the public subnet.
* **S3 Bucket:** One bucket for storing application data, etc.
* **IAM Role/Policy:** Permissions for the EC2 instance to access the S3 bucket.
* **EC2 Instance:** One instance for a web server, placed in the public subnet.


## Architecture Diagram
The following diagram, automatically generated by the `diagrams` and GitHub Actions, illustrates this project's architecture:
![AWS Architecture Diagram](diagrams/terraform_aws_demo_diagram.png)

### Automatic Updates via GitHub Actions
- This repository is configured with a GitHub Actions workflow (`.github/workflows/generate_diagram.yml`).
- When changes are pushed to the `main` branch, the workflow automatically runs `diagram_generator/generate_diagram.py`.
- If the generated diagram (`terraform_aws_demo_diagram.png`) has changed, the workflow automatically commits and pushes the updated file back to the repository.
⚠️ Remember that if you modify the Terraform (`.tf`) configuration files, you **must also manually update** the `diagram_generator/generate_diagram.py` script to accurately reflect those changes *before* this automated process runs.

### Generating the Diagram Locally
If you want to generate the diagram locally, follow these steps:
1. Ensure the necessary files are in the `diagram_generator/` directory. You must have `graphviz` installed on your system (it's a dependency for the `diagrams`).
2. Run the script:
    ```bash
    pip install -r diagram_generator/requirements.txt
    python diagram_generator/generate_diagram.py
    ```

This will generate/update the diagram file at `terraform_aws_demo_diagram.png`.


## Provisioning Infrastructure with Terraform
1. Ensure the necessary `.tf` files are present in the `terraform/` directory.
2. Navigate to the `terraform/` directory and initialize Terraform.
   ```bash
   cd terraform
   terraform init
   ```
3. Review the resources that will be created.
   ```bash
   terraform plan
   ```
4. Create the infrastructure on AWS.
   ```bash
   terraform apply
   ```
5. To remove the created resources.
   ```bash
   terraform destroy
   ```


## Required Tools
- **Terraform:** [Install Guide](https://learn.hashicorp.com/tutorials/terraform/install-cli)
- **AWS CLI:** Convenient for configuring AWS credentials. [Install Guide](https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html)
⚠️ Requires appropriate AWS credentials (access key, secret key, IAM role, etc.) configured. These credentials need permissions to create the necessary resources.
- **Graphviz:** A graph visualization software used by the `diagrams`.


## License
You are free to use this code for personal and educational purposes. Commercial use and redistribution are not allowed.
